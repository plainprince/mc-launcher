<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/tauri.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Minecraft Launcher</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div id="app">
      <!-- Login Screen -->
      <div id="login-screen" class="screen">
        <div class="container">
          <div class="header">
            <h1>Minecraft Client Launcher</h1>
            <p>Custom modded Minecraft client launcher with enhanced features</p>
          </div>

          <div class="card">
            <h2>Microsoft Authentication</h2>
            <div id="login-step-1" class="step">
              <p>Before launching Minecraft, please authenticate with your Microsoft account.</p>
              <button id="login-btn" class="primary-btn">
                Start Authentication
              </button>
            </div>

            <div id="login-step-2" class="step hidden">
              <p>Opening authentication URL...</p>
              <div class="loading-spinner"></div>
              <p class="text-sm">
                If the browser doesn't open automatically, 
                <a href="#" id="manual-auth-link" target="_blank">click here</a>
              </p>
            </div>

            <div id="url-auth-step" class="step hidden">
              <h3>Microsoft Authentication</h3>
              <p><strong>Please copy the complete URL from your browser after authentication:</strong></p>
              
              <div class="input-group" style="margin-top: 20px;">
                <label for="auth-code-input"><strong>Paste the complete URL from your browser after login:</strong></label>
                <input 
                  type="text" 
                  id="auth-code-input" 
                  placeholder="Paste the complete URL here (should contain code=...)"
                  class="code-input"
                  style="width: 100%; margin-top: 10px;"
                />
                <button id="complete-auth-btn" class="primary-btn" style="margin-top: 10px;">
                  Complete Login
                </button>
              </div>
              
              <p class="text-sm" style="margin-top: 15px;">
                <strong>Steps:</strong><br/>
                1. Authentication will open in your default browser<br/>
                2. Sign in with your Microsoft account that owns Minecraft<br/>
                3. After login, copy the entire URL from your browser's address bar<br/>
                4. Paste it in the field above and click "Complete Login"
              </p>
            </div>
          </div>


        </div>
      </div>

      <!-- Main Launcher Screen -->
      <div id="main-screen" class="screen hidden">
        <div class="container">
          <!-- Navigation Header -->
          <nav class="nav-header">
            <div class="nav-left">
              <h1>Minecraft Client</h1>
              <span id="user-info" class="user-badge"></span>
            </div>
            <div class="nav-right">
              <button id="settings-btn" class="icon-btn" title="Open Settings">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5a3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1c0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
                </svg>
              </button>
              <button id="logout-btn" class="icon-btn" title="Logout">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16 17v-3H9v-4h7V7l5 5-5 5M14 2a2 2 0 0 1 2 2v2h-2V4H4v16h10v-2h2v2a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h10Z"/>
                </svg>
              </button>
            </div>
          </nav>

          <div class="main-content">
            <!-- Client Launch Panel -->
            <div class="client-launch-panel">
              <div class="launch-container">
                <div class="launch-button-container">
                  <button id="launch-btn" class="large-launch-btn">
                    Launch Minecraft Client
                  </button>
                  <div class="version-selector" id="version-dropdown-btn">
                    <span id="selected-version" class="version-text">1.8.9</span>
                    <span class="version-arrow">▼</span>
                  </div>
                </div>
                
                <div class="launch-status">
                  <span id="status-dot" class="status-dot offline"></span>
                  <span id="status-text">Ready to launch</span>
                </div>
              </div>
            </div>

            <!-- Version Selection Modal -->
            <div id="version-modal" class="modal hidden">
              <div class="modal-content">
                <div class="modal-header">
                  <h2>Select Minecraft Version</h2>
                  <button id="close-version-modal" class="close-btn">×</button>
                </div>
                <div class="version-list">
                  <!-- Versions will be loaded dynamically -->
                </div>
              </div>
            </div>

            <!-- Logs Panel (Always Visible) -->
            <div class="logs-panel">
              <div class="logs-header" id="logs-header">
                <span>Console Output</span>
              </div>
              <div id="logs-content" class="logs-output">
                <div class="log-welcome">
                  Welcome to the Custom Minecraft Client!<br>
                  This launcher supports multiple Minecraft versions through ViaFabricPlus.<br>
                  Select any version from 1.8 to 1.21.8 for server compatibility.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Settings Modal -->
      <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Settings</h2>
            <button id="close-settings-btn" class="close-btn">×</button>
          </div>
          <div class="modal-body">
            <div class="settings-section">
              <h3>Performance</h3>
              <div class="setting-item">
                <label for="settings-memory-min">Minimum Memory (GB):</label>
                <div class="slider-container">
                  <input type="range" id="settings-memory-min" min="1" max="8" value="4" step="1" />
                  <span id="settings-memory-min-display">4 GB</span>
                </div>
              </div>
              <div class="setting-item">
                <label for="settings-memory-max">Maximum Memory (GB):</label>
                <div class="slider-container">
                  <input type="range" id="settings-memory-max" min="4" max="32" value="8" step="1" />
                  <span id="settings-memory-max-display">8 GB</span>
                </div>
              </div>
              <div class="setting-item">
                <label for="settings-gc">Garbage Collector:</label>
                <select id="settings-gc">
                  <option value="G1GC">G1 Garbage Collector (Recommended)</option>
                  <option value="ZGC">Z Garbage Collector (High Performance)</option>
                  <option value="ParallelGC">Parallel Garbage Collector</option>
                </select>
              </div>
            </div>

            <div class="settings-section">
              <h3>Downloads</h3>
              <div class="setting-item">
                <label for="settings-concurrent">Concurrent Downloads:</label>
                <div class="slider-container">
                  <input type="range" id="settings-concurrent" min="1" max="16" value="8" step="1" />
                  <span id="settings-concurrent-display">8</span>
                </div>
              </div>
              <div class="setting-item">
                <label for="settings-timeout">Download Timeout (seconds):</label>
                <div class="slider-container">
                  <input type="range" id="settings-timeout" min="30" max="600" value="300" step="30" />
                  <span id="settings-timeout-display">300s</span>
                </div>
              </div>
            </div>

            <div class="settings-section">
              <h3>Appearance</h3>
              <div class="setting-item">
                <label for="settings-theme">Theme:</label>
                <select id="settings-theme">
                  <option value="auto">Auto</option>
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                </select>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button id="save-settings-btn" class="primary-btn">Save Settings</button>
            <button id="reset-settings-btn" class="secondary-btn">Reset to Defaults</button>
          </div>
        </div>
      </div>

      <!-- Loading Overlay -->
      <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
          <div class="loading-spinner large"></div>
          <h2 id="loading-title">Loading...</h2>
          <p id="loading-message">Please wait while we set things up.</p>
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <span id="progress-text">0%</span>
        </div>
      </div>

      <!-- Notification System -->
      <div id="notifications" class="notifications-container"></div>
    </div>

    <script type="module" src="/main.js"></script>
  </body>
</html>